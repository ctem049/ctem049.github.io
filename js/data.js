/* mddata */
var mddata = `- updateTime: 2021-06-09

# 最近在看

- type: video

* [2021-05-30] (视频) [光 学 隐 形，就是有点费手](https://www.bilibili.com/video/BV1u64y1y7AE) ![](http://i2.hdslb.com/bfs/archive/d89d84f713d41e30c947d2b6c882c6e72a0e7114.jpg)
* [2021-05-31] (视频) [【恶霸提莫】上单征服者剑魔？就这](https://www.bilibili.com/video/BV1XQ4y1R7Wb) ![](http://i1.hdslb.com/bfs/archive/2b585f3a9efd26223d15c25301b0c1dfab9c51b9.jpg)
* [2021-05-24] (视频) [神秘斩杀！德鲁伊的终极奥义！【炉石骚套路 35】](https://www.bilibili.com/video/BV1v44y1r7B1) ![](http://i0.hdslb.com/bfs/archive/5ada0743c34d3c44f878e56879b14ae8a819c0c8.jpg)
* [2021-06-06] (视频) [【逗鱼时刻】第304期 我一万年没打过鸡杂了！](https://www.bilibili.com/video/BV1q64y1k7Yu) ![](http://i0.hdslb.com/bfs/archive/725a99e8a7a077da724e7c164020800cbc8158b3.jpg)
* [2021-06-06] (视频) [【星际老男孩】谐星语录之甜的还是咸的【加更一期】](https://www.bilibili.com/video/BV1zV411x7J8) ![](http://i2.hdslb.com/bfs/archive/05f8a36d484e7b7554e10207b6f105b7aeb0def3.png)
* [2021-06-06] (直播) [奶粉 @虎牙](https://www.huya.com/35399c) 炉石传说 ![](https://ww1.sinaimg.cn/mw2000/006gWYb8jw8fd63t19ya3j30hs0hlaag.jpg)
* [2021-05-28] (番剧) [摇曳百合 3☆High! ゆるゆり さん☆ハイ！](https://bgm.tv/subject/127573) ![](https://lain.bgm.tv/pic/cover/l/3e/f2/127573_HfPRJ.jpg)
* [2021-05-15] (番剧) [摇曳百合2 ゆるゆり♪♪](http://bgm.tv/subject/28900) ![](https://lain.bgm.tv/pic/cover/l/f2/9f/28900_PB3pC.jpg)
* [2021-05-08] (番剧) [摇曳百合 ゆるゆり](http://bgm.tv/subject/14588) ![](https://lain.bgm.tv/pic/cover/l/43/d9/14588_bDB2r.jpg)
* [2021-05-16] (视频) [【GNZ48】20210516 Class 4 《Waiting 4（肆）》卢静、黄楚茵生日公演](https://www.bilibili.com/video/BV1SU4y1t7qp) ![](http://i0.hdslb.com/bfs/archive/b0e38d9ab09c82025038399c8a210d21fbf8b81a.jpg)
* [2021-05-15] (视频) [【星际老男孩】谐星语录之有几个摊位](https://www.bilibili.com/video/BV1BK4y1d7ZQ) ![](http://i2.hdslb.com/bfs/archive/05f8a36d484e7b7554e10207b6f105b7aeb0def3.png)
* [2021-05-13] (视频) [【逗鱼时刻】第301期 国服第一雪崩是怎么练成的](https://www.bilibili.com/video/BV1BA411G7hE) ![](http://i1.hdslb.com/bfs/archive/99074e993537788c9e81f69253a01e69ba04a93e.jpg)

# 最近在听

- type: music

* [2021-05-26] [七森中☆ごらく部 - いぇす!ゆゆゆ☆ゆるゆり♪♪](https://y.qq.com/n/ryqq/songDetail/002QYqzw3eqKCO) ![](https://y.qq.com/music/photo_new/T002R300x300M000000YmL3W31weXH_1.jpg?max_age=2592000)
* [2021-05-08] [七森中☆ごらく部 - ゆりゆららららゆるゆり大事件](https://y.qq.com/n/ryqq/songDetail/001wVIRv0rmoUb) ![](https://y.qq.com/music/photo_new/T002R300x300M000003HNbwr0HJP5H_1.jpg?max_age=2592000)
* [2021-05-02] [Sweety - 樱花草](https://y.qq.com/n/yqq/song/000Tx0ZM2xaBhM.html) ![](https://y.gtimg.cn/music/photo_new/T002R300x300M000000pKXff1doeOd_3.jpg?max_age=2592000)
* [2021-04-02] [林俊杰 - 美人鱼](https://y.qq.com/n/yqq/song/002ASCKm3ROw7t.html) ![](https://y.gtimg.cn/music/photo_new/T002R300x300M000000y5gq7449K9I_1.jpg?max_age=2592000)
* [2021-03-15] [周兴哲 - 永不失联的爱](https://y.qq.com/n/yqq/song/004c4CEB3jfz7a.html) ![](https://y.gtimg.cn/music/photo_new/T002R300x300M000003xoLyf0Xj3Oe_1.jpg?max_age=2592000)

# 最近在玩

- type: game

* [2020-11-26] [瘟疫公司](https://store.steampowered.com/app/246620/Plague_Inc_Evolved) Plague Inc. ![](https://cdn.akamai.steamstatic.com/steam/apps/246620/header.jpg)
* [2021-03-15] [云顶之弈](https://lol.qq.com/tft/) Team Fight Tatics ![](https://game.gtimg.cn/images/lol/tft/content-site/logo-tft.png)
* [2021-06-07] [英雄联盟](https://lol.qq.com) League of Legends ![](https:////game.gtimg.cn/images/lol/v3/logo-public.png)
* [2020-12-13] [我的世界](https://mc.163.com) Minecraft ![](https://webinput.nie.netease.com/img/mc/logo.png)
* [2021-06-08] [炉石传说](https://hs.blizzard.cn) Hearth Stone ![](https://blz.nosdn.127.net/1/tm/hearthstone/activities/barrens/landing-logo-xresdftdds.png)

# 最近在读

- type: text

* [2021-05-30] [科普向：OVA、OAD、SP和剧场版，他们究竟有何区别](https://www.bilibili.com/read/cv7433772/)
* [2021-05-09] [Citrus~反传统的第一女主角](https://www.bilibili.com/read/cv188081)`;

function getData() {
    var oReq = new XMLHttpRequest();
    oReq.open("GET", "./md/data.md?" + new Date().getTime(), false); // 同步请求
    oReq.send(null);//发送数据需要自定义，这里发送的是JSON结构
    var result = oReq.responseText;//响应结果
    return result;
}

try {
    var result = getData();
    if (result) {
        mddata = result;
    }
} catch (e) {
    console.log(e);
}

var md = markdownit();
function toJSO(mddata) {
    var data = {};
    var parse = md.parse(mddata, {});
    var _this = data;
    var type = '';
    var block = {};
    // console.log('parse',parse);
    for (var i = 0; i < parse.length; i++) {
        var o = parse[i];

        // 属性处理 '- attr: value'
        if (o.type == 'bullet_list_open' && o.markup == '-') {
            // 进入属性处理
            type = 'attr';
        }
        if (o.type == 'inline' && type == 'attr') {
            // 获取属性和值
            var t = o.content.split(': ', 2);
            // console.log('attr:value',t);
            _this[t[0]] = t[1];
        }
        if (o.type == 'bullet_list_close' && o.markup == '-') {
            // 退出属性处理
            type = '';
        }

        // 块处理 '# title'
        if (o.type == 'heading_open' && o.markup == '#') {
            // 退出上一个块
            if (Object.keys(block).length != 0) // 上一个块非空
            {
                _this = data; // 如需实现多层嵌套，需修改此部分逻辑
                _this.content.push(block);
            }
            // 进入下一个块
            if (!_this.content) _this.content = [];
            block = {};
            _this = block;
            // 进入标题处理
            type = 'title';
        }
        if (o.type == 'inline' && type == 'title') {
            // 写入标题
            _this['title'] = o.content;
            _this['load'] = false; // 默认不全部加载
        }
        if (o.type == 'heading_close' && type == 'title') {
            // 退出标题处理
            type = '';
        }

        // 列表处理 '* [updateTime] content'
        if (o.type == 'bullet_list_open' && o.markup == '*') {
            // 进入列表处理
            _this['list'] = [];
            type = 'list';
        }
        if (o.type == 'inline' && type == 'list') {
            // 写入列表内容
            var reg = /\[(.+?)\]/;
            var upT = o.content.match(reg)[1];
            var con = md.renderInline(o.content.replace(reg, '').replace(/(^\s*)|(\s*$)/g, ""));
            // 移动图片位置
            var imgreg = /<img.+?src=\"(.+?)\".*>/
            // var imgreg = /<img.*?src=[\"|\']?(.*?)[\"|\']?\s.*?>/i
            var hrefreg = /<a.+?href=\"(.+?)\".*>/
            if (con.match(imgreg)) {
                if (con.match(hrefreg)) {
                    con = '<a href="' + con.match(hrefreg)[1] + '"><img referrerpolicy="no-referrer" src="' + con.match(imgreg)[1] + '"></a>' + '<div class="y-box-text">' + con.replace(imgreg, "") + '</div>'
                } else {
                    con = con.match(imgreg)[0] + '<div class="y-box-text">' + con.replace(imgreg, "") + '</div>'
                }
            }
            // 写入列表
            _this['list'].push({
                content: con,
                updateTime: upT
            });
        }
        if (o.type == 'bullet_list_close' && o.markup == '*') {
            // 退出列表处理
            type = '';
        }

    }

    _this = data;
    if (_this.content) if (Object.keys(block).length != 0) // 上一个块非空
    {
        _this.content.push(block);
        block = {};
    }
    return data;
}

var data = toJSO(mddata);

// 排序处理
for (var i in data.content) {
    data.content[i].list = data.content[i].list.sort((a, b) => Date.parse(b.updateTime) - Date.parse(a.updateTime));
}

console.log(data);